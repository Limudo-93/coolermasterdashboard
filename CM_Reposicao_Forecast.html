<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CM Reposi√ß√£o & Forecast ‚Äî Brasil 2026</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<style>
  :root {
    --bg: #09090b;
    --card: #18181b;
    --border: #27272a;
    --accent: #7c3aed;
    --text: #fafafa;
    --muted: #71717a;
    --red: #ef4444;
    --yellow: #eab308;
    --green: #22c55e;
    --gray: #52525b;

    --kabum: #0066CC;
    --pichau: #E31E24;
    --oderco: #22C55E;
    --vaip: #8B5CF6;
    --mazer: #EAB308;
    --gmi: #EC4899;
    --allnations: #92400E;
  }
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body { background: var(--bg); color: var(--text); font-family: 'Inter', system-ui, sans-serif; font-size: 14px; min-height: 100vh; }

  /* HEADER */
  .header { padding: 20px 24px 0; border-bottom: 1px solid var(--border); }
  .header-top { display: flex; align-items: center; gap: 12px; margin-bottom: 16px; }
  .logo { width: 32px; height: 32px; background: var(--accent); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 16px; }
  .header-title h1 { font-size: 18px; font-weight: 700; letter-spacing: -0.02em; }
  .header-title p { font-size: 12px; color: var(--muted); margin-top: 2px; }
  .header-badge { margin-left: auto; background: #1e1b4b; color: #a5b4fc; padding: 4px 10px; border-radius: 20px; font-size: 11px; border: 1px solid #312e81; }

  /* TABS */
  .tabs { display: flex; gap: 0; }
  .tab-btn { padding: 10px 20px; background: none; border: none; color: var(--muted); cursor: pointer; font-size: 13px; font-weight: 500; border-bottom: 2px solid transparent; transition: all 0.15s; }
  .tab-btn.active { color: var(--text); border-bottom-color: var(--accent); }
  .tab-btn:hover:not(.active) { color: var(--text); }

  /* CONTENT */
  .content { padding: 20px 24px; }
  .tab-pane { display: none; }
  .tab-pane.active { display: block; }

  /* ALERT CARDS */
  .alert-row { display: flex; gap: 12px; margin-bottom: 20px; flex-wrap: wrap; }
  .alert-card { flex: 1; min-width: 200px; background: var(--card); border: 1px solid var(--border); border-radius: 10px; padding: 12px 16px; display: flex; align-items: flex-start; gap: 10px; }
  .alert-card.red { border-left: 3px solid var(--red); }
  .alert-card.black { border-left: 3px solid var(--gray); }
  .alert-card.yellow { border-left: 3px solid var(--yellow); }
  .alert-icon { font-size: 18px; margin-top: 1px; }
  .alert-title { font-size: 12px; font-weight: 600; color: var(--text); }
  .alert-sub { font-size: 11px; color: var(--muted); margin-top: 3px; }

  /* METRICS ROW */
  .metrics-row { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-bottom: 20px; }
  .metric-card { background: var(--card); border: 1px solid var(--border); border-radius: 10px; padding: 14px 16px; }
  .metric-label { font-size: 11px; color: var(--muted); text-transform: uppercase; letter-spacing: 0.04em; }
  .metric-value { font-size: 22px; font-weight: 700; margin-top: 4px; letter-spacing: -0.03em; }
  .metric-sub { font-size: 11px; color: var(--muted); margin-top: 3px; }

  /* TWO COLUMN LAYOUT */
  .two-col { display: grid; grid-template-columns: 1fr 380px; gap: 16px; margin-bottom: 20px; }
  @media (max-width: 1100px) { .two-col { grid-template-columns: 1fr; } }

  /* CARD */
  .card { background: var(--card); border: 1px solid var(--border); border-radius: 10px; }
  .card-header { padding: 14px 16px; border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; }
  .card-title { font-size: 13px; font-weight: 600; }
  .card-body { padding: 16px; }

  /* TABLE */
  .table-wrap { overflow-x: auto; }
  table { width: 100%; border-collapse: collapse; }
  th { font-size: 11px; text-transform: uppercase; letter-spacing: 0.04em; color: var(--muted); padding: 8px 12px; text-align: left; border-bottom: 1px solid var(--border); white-space: nowrap; }
  td { padding: 10px 12px; border-bottom: 1px solid #1f1f22; font-size: 13px; white-space: nowrap; }
  tr:last-child td { border-bottom: none; }
  tr:hover td { background: #1e1e22; }
  .total-row td { background: #1a1a1f; font-weight: 600; border-top: 1px solid var(--border); }

  /* DISTRIBUTOR DOT */
  .dist-dot { width: 10px; height: 10px; border-radius: 50%; display: inline-block; margin-right: 8px; flex-shrink: 0; }
  .dist-name { display: flex; align-items: center; }

  /* WOS BADGE */
  .wos-badge { display: inline-flex; align-items: center; gap: 6px; font-weight: 600; }
  .sem-dot { width: 10px; height: 10px; border-radius: 50%; }
  .sem-red { background: var(--red); }
  .sem-yellow { background: var(--yellow); }
  .sem-green { background: var(--green); }
  .sem-black { background: var(--gray); }

  /* RECOMMENDATION */
  .rec-tag { display: inline-block; padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: 500; }
  .rec-monitor { background: #1c2333; color: #60a5fa; }
  .rec-reduce { background: #2a1515; color: #f87171; }
  .rec-high { background: #1a1a1a; color: #a1a1aa; }

  /* CHART CONTAINER */
  .chart-box { position: relative; }

  /* FORECAST SECTION */
  .gap-card { background: linear-gradient(135deg, #1e1b4b, #18181b); border: 1px solid #312e81; border-radius: 10px; padding: 20px; margin-bottom: 20px; }
  .gap-card h3 { font-size: 13px; color: #a5b4fc; margin-bottom: 10px; text-transform: uppercase; letter-spacing: 0.05em; }
  .gap-main { font-size: 28px; font-weight: 800; color: #f87171; letter-spacing: -0.03em; }
  .gap-detail { font-size: 12px; color: var(--muted); margin-top: 6px; }

  .forecast-metrics { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 20px; }

  /* PROGRESS */
  .progress-bar { width: 100%; height: 6px; background: var(--border); border-radius: 3px; overflow: hidden; margin-top: 6px; }
  .progress-fill { height: 100%; border-radius: 3px; transition: width 0.3s; }

  /* LEGEND */
  .legend { display: flex; gap: 16px; flex-wrap: wrap; }
  .legend-item { display: flex; align-items: center; gap: 6px; font-size: 12px; color: var(--muted); }
  .legend-dot { width: 10px; height: 10px; border-radius: 50%; }
  .legend-dash { width: 20px; height: 2px; border-top: 2px dashed currentColor; }
</style>
</head>
<body>

<div class="header">
  <div class="header-top">
    <div class="logo">üìä</div>
    <div class="header-title">
      <h1>CM Reposi√ß√£o & Forecast</h1>
      <p>Brasil 2026 ¬∑ Dados W01‚ÄìW07 ¬∑ Atualizado em 18/02/2026</p>
    </div>
    <div class="header-badge">FY2026 Q1</div>
  </div>
  <div class="tabs">
    <button class="tab-btn active" onclick="switchTab('tab-motor')">‚öôÔ∏è Motor de Reposi√ß√£o</button>
    <button class="tab-btn" onclick="switchTab('tab-forecast')">üìà 6MSF Forecast</button>
  </div>
</div>

<!-- ============================================================ TAB 1 ============================================================ -->
<div id="tab-motor" class="content tab-pane active">

  <!-- ALERT CARDS -->
  <div class="alert-row">
    <div class="alert-card yellow">
      <div class="alert-icon">üü°</div>
      <div>
        <div class="alert-title">KaBuM ‚Äî Monitorar</div>
        <div class="alert-sub">8,3 sem de estoque ¬∑ repor em 2‚Äì3 semanas</div>
      </div>
    </div>
    <div class="alert-card black">
      <div class="alert-icon">‚ö´</div>
      <div>
        <div class="alert-title">Oder√ßo ‚Äî EXCESSO CR√çTICO</div>
        <div class="alert-sub">212 semanas ¬∑ negociar promo√ß√£o urgente</div>
      </div>
    </div>
    <div class="alert-card black">
      <div class="alert-icon">‚ö´</div>
      <div>
        <div class="alert-title">VAIP / GMI / Mazer / All Nations</div>
        <div class="alert-sub">16‚Äì72 sem de estoque ¬∑ priorizar sell-out</div>
      </div>
    </div>
    <div class="alert-card black">
      <div class="alert-icon">‚ö´</div>
      <div>
        <div class="alert-title">Pichau ‚Äî Excesso</div>
        <div class="alert-sub">35 sem ¬∑ 92 SKUs ¬∑ priorizar sell-out</div>
      </div>
    </div>
  </div>

  <!-- METRICS -->
  <div class="metrics-row">
    <div class="metric-card">
      <div class="metric-label">Estoque Total</div>
      <div class="metric-value">49.853</div>
      <div class="metric-sub">unidades em campo</div>
    </div>
    <div class="metric-card">
      <div class="metric-label">Valor em Estoque</div>
      <div class="metric-value">$812K</div>
      <div class="metric-sub">FOB HK consolidado</div>
    </div>
    <div class="metric-card">
      <div class="metric-label">Sell-out W01‚ÄìW07</div>
      <div class="metric-value">1.514</div>
      <div class="metric-sub">un/sem (m√©dia de 7 semanas)</div>
    </div>
    <div class="metric-card">
      <div class="metric-label">WOS M√©dio</div>
      <div class="metric-value" style="color: var(--gray);">49,3</div>
      <div class="metric-sub">semanas ¬∑ target 8‚Äì12 sem</div>
    </div>
  </div>

  <!-- TABLE + CHART -->
  <div class="two-col">
    <div class="card">
      <div class="card-header">
        <span class="card-title">Invent√°rio por Distribuidor ‚Äî WOS Analysis</span>
        <div class="legend">
          <div class="legend-item"><span class="sem-dot sem-red" style="border-radius:50%;display:inline-block;width:10px;height:10px;background:var(--red)"></span> &lt;4sem</div>
          <div class="legend-item"><span class="sem-dot" style="border-radius:50%;display:inline-block;width:10px;height:10px;background:var(--yellow)"></span> 4‚Äì8sem</div>
          <div class="legend-item"><span class="sem-dot" style="border-radius:50%;display:inline-block;width:10px;height:10px;background:var(--green)"></span> 8‚Äì12sem</div>
          <div class="legend-item"><span class="sem-dot" style="border-radius:50%;display:inline-block;width:10px;height:10px;background:var(--gray)"></span> &gt;12sem</div>
        </div>
      </div>
      <div class="table-wrap">
        <table>
          <thead>
            <tr>
              <th>Distribuidor</th>
              <th>Estoque (un)</th>
              <th>Valor</th>
              <th>SKUs</th>
              <th>Sell-out/sem</th>
              <th>WOS</th>
              <th>Status</th>
              <th>Recomenda√ß√£o</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><span class="dist-name"><span class="dist-dot" style="background:#0066CC"></span>KaBuM</span></td>
              <td>8.437</td><td>$173K</td><td>74</td><td>1.011</td>
              <td><span class="wos-badge"><span class="sem-dot" style="background:var(--yellow)"></span>8,3</span></td>
              <td><span class="rec-tag rec-monitor">üü° Aten√ß√£o</span></td>
              <td><span class="rec-tag rec-monitor">Monitorar ‚Äî repor em 2-3 sem</span></td>
            </tr>
            <tr>
              <td><span class="dist-name"><span class="dist-dot" style="background:#22C55E"></span>Oder√ßo</span></td>
              <td>29.291</td><td>$144K</td><td>51</td><td>138</td>
              <td><span class="wos-badge"><span class="sem-dot" style="background:var(--gray)"></span>212</span></td>
              <td><span class="rec-tag rec-reduce">‚ö´ Cr√≠tico</span></td>
              <td><span class="rec-tag rec-reduce">REDUZIR ‚Äî promo√ß√£o urgente</span></td>
            </tr>
            <tr>
              <td><span class="dist-name"><span class="dist-dot" style="background:#E31E24"></span>Pichau</span></td>
              <td>4.203</td><td>$183K</td><td>92</td><td>120</td>
              <td><span class="wos-badge"><span class="sem-dot" style="background:var(--gray)"></span>35</span></td>
              <td><span class="rec-tag rec-high">‚ö´ Excesso</span></td>
              <td><span class="rec-tag rec-high">Priorizar sell-out</span></td>
            </tr>
            <tr>
              <td><span class="dist-name"><span class="dist-dot" style="background:#EAB308"></span>Mazer</span></td>
              <td>2.953</td><td>$135K</td><td>48</td><td>41</td>
              <td><span class="wos-badge"><span class="sem-dot" style="background:var(--gray)"></span>72</span></td>
              <td><span class="rec-tag rec-high">‚ö´ Excesso</span></td>
              <td><span class="rec-tag rec-high">Priorizar sell-out</span></td>
            </tr>
            <tr>
              <td><span class="dist-name"><span class="dist-dot" style="background:#8B5CF6"></span>VAIP</span></td>
              <td>2.299</td><td>$54K</td><td>36</td><td>138</td>
              <td><span class="wos-badge"><span class="sem-dot" style="background:var(--gray)"></span>16,7</span></td>
              <td><span class="rec-tag rec-high">‚ö´ Excesso</span></td>
              <td><span class="rec-tag rec-high">Priorizar sell-out</span></td>
            </tr>
            <tr>
              <td><span class="dist-name"><span class="dist-dot" style="background:#EC4899"></span>GMI</span></td>
              <td>2.200</td><td>$68K</td><td>27</td><td>53</td>
              <td><span class="wos-badge"><span class="sem-dot" style="background:var(--gray)"></span>41,5</span></td>
              <td><span class="rec-tag rec-high">‚ö´ Excesso</span></td>
              <td><span class="rec-tag rec-high">Priorizar sell-out</span></td>
            </tr>
            <tr>
              <td><span class="dist-name"><span class="dist-dot" style="background:#92400E"></span>All Nations</span></td>
              <td>470</td><td>$54K</td><td>17</td><td>14</td>
              <td><span class="wos-badge"><span class="sem-dot" style="background:var(--gray)"></span>33,6</span></td>
              <td><span class="rec-tag rec-high">‚ö´ Excesso</span></td>
              <td><span class="rec-tag rec-high">Priorizar sell-out</span></td>
            </tr>
            <tr class="total-row">
              <td>TOTAL</td>
              <td>49.853</td><td>$812K</td><td>‚Äî</td><td>1.514</td>
              <td><span style="color:var(--gray);font-weight:700">49,3 avg</span></td>
              <td colspan="2"><span style="color:var(--muted);font-size:12px">6 de 7 distribuidores com excesso</span></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="card">
      <div class="card-header">
        <span class="card-title">WOS por Distribuidor</span>
        <span style="font-size:11px;color:var(--muted)">linha ref. = 12 sem</span>
      </div>
      <div class="card-body">
        <div class="chart-box" style="height:280px">
          <canvas id="wosChart"></canvas>
        </div>
      </div>
    </div>
  </div>

</div>

<!-- ============================================================ TAB 2 ============================================================ -->
<div id="tab-forecast" class="content tab-pane">

  <!-- GAP CARD -->
  <div class="gap-card">
    <h3>Gap Analysis FY2026</h3>
    <div class="gap-main">-$4,24M (-76%)</div>
    <div class="gap-detail">No run rate atual, FY2026 fecha em <strong>$1,34M</strong> vs target <strong>$5,584M</strong> ‚Äî necess√°rio crescer <strong style="color:#f87171">3,8√ó</strong></div>
    <div style="margin-top:12px">
      <div style="display:flex;justify-content:space-between;font-size:11px;color:var(--muted);margin-bottom:4px"><span>Proje√ß√£o atual</span><span>Target FY2026</span></div>
      <div class="progress-bar" style="height:10px">
        <div class="progress-fill" style="width:24%;background:var(--accent)"></div>
      </div>
      <div style="display:flex;justify-content:space-between;font-size:11px;color:var(--muted);margin-top:4px"><span>$1,34M</span><span>$5,584M</span></div>
    </div>
  </div>

  <!-- FORECAST METRICS -->
  <div class="forecast-metrics">
    <div class="metric-card">
      <div class="metric-label">Run Rate Atual</div>
      <div class="metric-value">1.514</div>
      <div class="metric-sub">un/sem ¬∑ $42.129/sem</div>
    </div>
    <div class="metric-card">
      <div class="metric-label">Proje√ß√£o W08‚ÄìW33 (26 sem)</div>
      <div class="metric-value">39.364</div>
      <div class="metric-sub">un ¬∑ $1.095.354 FOB</div>
    </div>
    <div class="metric-card">
      <div class="metric-label">Targets Restantes FY2026</div>
      <div class="metric-value" style="color:#f87171">$4.163K</div>
      <div class="metric-sub">Q2=$1.499K ¬∑ Q3=$1.364K ¬∑ Q4=$1.300K</div>
    </div>
  </div>

  <!-- CHART -->
  <div class="card" style="margin-bottom:20px">
    <div class="card-header">
      <span class="card-title">Sell-out Semanal ‚Äî Hist√≥rico + Proje√ß√£o 26 Semanas</span>
      <div class="legend">
        <div class="legend-item"><span style="display:inline-block;width:16px;height:3px;background:var(--accent);border-radius:2px"></span>Real (un)</div>
        <div class="legend-item"><span style="display:inline-block;width:16px;height:3px;background:#52525b;border-radius:2px;border-top:2px dashed #52525b"></span>Proje√ß√£o (un)</div>
        <div class="legend-item"><span style="display:inline-block;width:16px;height:3px;background:#16a34a;border-radius:2px"></span>Real FOB</div>
        <div class="legend-item"><span style="display:inline-block;width:16px;height:3px;background:#15803d;border-radius:2px;opacity:0.6"></span>Proj FOB</div>
      </div>
    </div>
    <div class="card-body">
      <div class="chart-box" style="height:300px">
        <canvas id="forecastChart"></canvas>
      </div>
    </div>
  </div>

  <!-- DISTRIBUTOR PROJECTION TABLE -->
  <div class="card">
    <div class="card-header">
      <span class="card-title">Proje√ß√£o por Distribuidor (W08‚ÄìW33 ¬∑ 26 semanas)</span>
    </div>
    <div class="table-wrap">
      <table>
        <thead>
          <tr>
            <th>Distribuidor</th>
            <th>Share Atual</th>
            <th>Sell-out/sem atual</th>
            <th>Proje√ß√£o 26 sem (un)</th>
            <th>Proje√ß√£o 26 sem (FOB)</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><span class="dist-name"><span class="dist-dot" style="background:#0066CC"></span>KaBuM</span></td>
            <td>66,8%</td><td>1.011</td>
            <td>26.286</td><td>$731K</td>
          </tr>
          <tr>
            <td><span class="dist-name"><span class="dist-dot" style="background:#8B5CF6"></span>VAIP</span></td>
            <td>9,1%</td><td>138</td>
            <td>3.588</td><td>$100K</td>
          </tr>
          <tr>
            <td><span class="dist-name"><span class="dist-dot" style="background:#22C55E"></span>Oder√ßo</span></td>
            <td>9,1%</td><td>138</td>
            <td>3.588</td><td>$100K</td>
          </tr>
          <tr>
            <td><span class="dist-name"><span class="dist-dot" style="background:#E31E24"></span>Pichau</span></td>
            <td>7,9%</td><td>120</td>
            <td>3.120</td><td>$87K</td>
          </tr>
          <tr>
            <td><span class="dist-name"><span class="dist-dot" style="background:#EC4899"></span>GMI</span></td>
            <td>3,5%</td><td>53</td>
            <td>1.378</td><td>$38K</td>
          </tr>
          <tr>
            <td><span class="dist-name"><span class="dist-dot" style="background:#EAB308"></span>Mazer</span></td>
            <td>2,7%</td><td>41</td>
            <td>1.066</td><td>$30K</td>
          </tr>
          <tr>
            <td><span class="dist-name"><span class="dist-dot" style="background:#92400E"></span>All Nations</span></td>
            <td>0,9%</td><td>14</td>
            <td>364</td><td>$10K</td>
          </tr>
          <tr class="total-row">
            <td>TOTAL</td>
            <td>100%</td><td>1.514</td>
            <td>39.364</td><td>$1.095K</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

</div>

<script>
// TAB SWITCHING
function switchTab(id) {
  document.querySelectorAll('.tab-pane').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  event.currentTarget.classList.add('active');
  // Re-render chart if needed
  if (id === 'tab-forecast' && !forecastRendered) renderForecastChart();
  if (id === 'tab-motor' && !wosRendered) renderWosChart();
}

// ---- CHART DEFAULTS ----
Chart.defaults.color = '#71717a';
Chart.defaults.borderColor = '#27272a';
Chart.defaults.font.family = "'Inter', system-ui, sans-serif";

// ---- WOS HORIZONTAL BAR CHART ----
let wosRendered = false;
function renderWosChart() {
  const ctx = document.getElementById('wosChart').getContext('2d');
  const labels = ['KaBuM','Pichau','All Nations','VAIP','GMI','Mazer','Oder√ßo'];
  const data   = [8.3, 35, 33.6, 16.7, 41.5, 72, 212];
  const colors = ['#0066CC','#E31E24','#92400E','#8B5CF6','#EC4899','#EAB308','#22C55E'];

  new Chart(ctx, {
    type: 'bar',
    data: {
      labels,
      datasets: [
        {
          label: 'WOS (semanas)',
          data,
          backgroundColor: colors.map(c => c + '99'),
          borderColor: colors,
          borderWidth: 2,
          borderRadius: 4,
        }
      ]
    },
    options: {
      indexAxis: 'y',
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: { display: false },
        tooltip: {
          callbacks: {
            label: ctx => `${ctx.parsed.x.toFixed(1)} semanas`
          }
        },
        annotation: {}
      },
      scales: {
        x: {
          grid: { color: '#27272a' },
          ticks: { color: '#71717a' },
          title: { display: true, text: 'Weeks of Stock (WOS)', color: '#71717a', font: { size: 11 } }
        },
        y: { grid: { color: '#27272a' }, ticks: { color: '#fafafa' } }
      }
    },
    plugins: [{
      id: 'refLine',
      afterDraw(chart) {
        const { ctx, chartArea, scales } = chart;
        const x = scales.x.getPixelForValue(12);
        ctx.save();
        ctx.beginPath();
        ctx.moveTo(x, chartArea.top);
        ctx.lineTo(x, chartArea.bottom);
        ctx.strokeStyle = '#7c3aed';
        ctx.lineWidth = 2;
        ctx.setLineDash([6, 3]);
        ctx.stroke();
        ctx.setLineDash([]);
        ctx.fillStyle = '#a78bfa';
        ctx.font = '11px Inter, system-ui';
        ctx.fillText('12 sem', x + 4, chartArea.top + 14);
        ctx.restore();
      }
    }]
  });
  wosRendered = true;
}
renderWosChart();

// ---- FORECAST LINE CHART ----
let forecastRendered = false;
function renderForecastChart() {
  const ctx = document.getElementById('forecastChart').getContext('2d');

  const realLabels  = ['W01','W02','W03','W04','W05','W06','W07'];
  const realUnits   = [1200,1400,1600,1500,1450,1550,1897];
  const realFOB     = [33600,39200,44800,42000,40600,43400,53000];

  const projLabels  = [];
  const projUnits   = [];
  const projFOB     = [];
  for (let w = 8; w <= 33; w++) {
    projLabels.push(`W${String(w).padStart(2,'0')}`);
    projUnits.push(1514);
    projFOB.push(42129);
  }

  const allLabels = [...realLabels, ...projLabels];
  const unitsReal = [...realUnits, ...Array(26).fill(null)];
  const unitsProjArr = [...Array(7).fill(null), ...projUnits];
  const fobReal   = [...realFOB, ...Array(26).fill(null)];
  const fobProjArr = [...Array(7).fill(null), ...projFOB];
  // Bridge point
  unitsReal[7] = 1514;
  fobReal[7] = 42129;

  new Chart(ctx, {
    type: 'line',
    data: {
      labels: allLabels,
      datasets: [
        {
          label: 'Real (un)',
          data: unitsReal,
          borderColor: '#7c3aed',
          backgroundColor: 'rgba(124,58,237,0.1)',
          borderWidth: 2.5,
          pointRadius: 4,
          pointBackgroundColor: '#7c3aed',
          tension: 0.3,
          yAxisID: 'y',
          fill: false,
        },
        {
          label: 'Proje√ß√£o (un)',
          data: unitsProjArr,
          borderColor: '#52525b',
          backgroundColor: 'rgba(82,82,91,0.05)',
          borderWidth: 2,
          borderDash: [6, 4],
          pointRadius: 2,
          tension: 0,
          yAxisID: 'y',
          fill: false,
        },
        {
          label: 'Real FOB ($)',
          data: fobReal,
          borderColor: '#16a34a',
          backgroundColor: 'rgba(22,163,74,0.05)',
          borderWidth: 2,
          pointRadius: 3,
          tension: 0.3,
          yAxisID: 'y2',
          fill: false,
        },
        {
          label: 'Proje√ß√£o FOB ($)',
          data: fobProjArr,
          borderColor: '#15803d',
          backgroundColor: 'transparent',
          borderWidth: 1.5,
          borderDash: [6, 4],
          pointRadius: 1,
          tension: 0,
          yAxisID: 'y2',
          fill: false,
        }
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: {
          display: true,
          labels: { color: '#a1a1aa', boxWidth: 14, font: { size: 11 } }
        },
        tooltip: { mode: 'index', intersect: false }
      },
      scales: {
        x: {
          grid: { color: '#27272a' },
          ticks: { color: '#71717a', maxTicksLimit: 16, font: { size: 10 } }
        },
        y: {
          position: 'left',
          grid: { color: '#27272a' },
          ticks: { color: '#71717a' },
          title: { display: true, text: 'Unidades/sem', color: '#71717a', font: { size: 11 } }
        },
        y2: {
          position: 'right',
          grid: { drawOnChartArea: false },
          ticks: { color: '#71717a', callback: v => '$' + (v/1000).toFixed(0) + 'K' },
          title: { display: true, text: 'FOB HK ($)', color: '#71717a', font: { size: 11 } }
        }
      }
    },
    plugins: [{
      id: 'splitLine',
      afterDraw(chart) {
        const { ctx, chartArea, scales } = chart;
        const x = scales.x.getPixelForValue(6);
        ctx.save();
        ctx.beginPath();
        ctx.moveTo(x, chartArea.top);
        ctx.lineTo(x, chartArea.bottom);
        ctx.strokeStyle = '#3f3f46';
        ctx.lineWidth = 1;
        ctx.setLineDash([4, 3]);
        ctx.stroke();
        ctx.setLineDash([]);
        ctx.fillStyle = '#71717a';
        ctx.font = '10px Inter, system-ui';
        ctx.fillText('‚ñ∂ Proje√ß√£o', x + 4, chartArea.top + 14);
        ctx.restore();
      }
    }]
  });
  forecastRendered = true;
}
</script>
</body>
</html>
